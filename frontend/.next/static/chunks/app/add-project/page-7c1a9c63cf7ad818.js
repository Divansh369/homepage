(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[686],{2963:(e,t,a)=>{Promise.resolve().then(a.bind(a,8705))},6352:(e,t,a)=>{"use strict";a.d(t,{D:()=>n,N:()=>o});var l=a(5155),s=a(2115);let r=(0,s.createContext)(void 0),o=e=>{let{children:t}=e,[a,o]=(0,s.useState)("light");(0,s.useEffect)(()=>{let e=localStorage.getItem("theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches,a=e||(t?"dark":"light");o(a),document.documentElement.setAttribute("data-theme",a)},[]);let n=()=>{o(e=>{let t="light"===e?"dark":"light";return localStorage.setItem("theme",t),document.documentElement.setAttribute("data-theme",t),t})},c=(0,s.useMemo)(()=>({theme:a,toggleTheme:n}),[a]);return(0,l.jsx)(r.Provider,{value:c,children:t})},n=()=>{let e=(0,s.useContext)(r);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}},8705:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u});var l=a(5155),s=a(2115),r=a(6874),o=a.n(r),n=a(5028),c=a(6352),i=a(6766),d=a(1890);let m=(0,n.default)(()=>a.e(183).then(a.bind(a,9183)),{loadableGenerated:{webpack:()=>[9183]},ssr:!1,loading:()=>(0,l.jsx)("div",{style:{minHeight:"38px",padding:"8px 10px",border:"1px solid #ccc",borderRadius:"4px",backgroundColor:"#eee",color:"#aaa"},children:"Loading..."})}),h=d.env.NEXT_PUBLIC_FIXED_HOST||"",p="http://localhost:1024";function u(){let{theme:e}=(0,c.D)(),[t,a]=(0,s.useState)([]),[r,n]=(0,s.useState)(!0),[d,u]=(0,s.useState)(null),[j,x]=(0,s.useState)(!1),[g,f]=(0,s.useState)(null),[b,v]=(0,s.useState)(null),[N,y]=(0,s.useState)(null),[C,F]=(0,s.useState)({projectName:"",description:"",iconFilename:"",startCommand:"",stopCommand:"",scheme:"http",port:"",host:h}),[w,S]=(0,s.useState)([]),k=e=>{let{name:t,value:a}=e.target;F(e=>({...e,[t]:a}))},P=()=>{F({projectName:"",description:"",iconFilename:"",startCommand:"",stopCommand:"",scheme:"http",port:"",host:h}),S([])};(0,s.useEffect)(()=>{(async()=>{n(!0),u(null);try{let e=await fetch("".concat(p,"/api/labels"));if(!e.ok)throw Error("Labels fetch failed: ".concat(e.status));let t=await e.json();a(t)}catch(e){u(e.message)}finally{n(!1)}})()},[]);let E=async e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!a)return;y(null);let l=new FormData;l.append("icon",a);try{let e=await fetch("".concat(p,"/api/upload/icon"),{method:"POST",body:l}),t=await e.json();if(!e.ok)throw Error(t.error||"Upload failed");F(e=>({...e,iconFilename:t.filePath}))}catch(e){console.error("Upload error:",e),y(e.message)}},I=(0,s.useCallback)(()=>t.map(e=>({value:String(e.id),label:"".concat(e.name," (").concat(e.label_type,")")})),[t]),_=async e=>{if(e.preventDefault(),f(null),v(null),!C.projectName||!C.startCommand||!C.port){f("Project Name, Start Command, and a valid Port are required.");return}x(!0);let t={...C,selectedLabels:w.map(e=>parseInt(e.value))};try{let e=await fetch("".concat(p,"/api/add-project"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),a=await e.json();if(!e.ok)throw Error(a.error||"Failed to add project");v('Project "'.concat(t.projectName,'" added successfully!')),P()}catch(e){f("Failed to add project: ".concat(e.message))}finally{x(!1)}},T=C.iconFilename?"".concat(p).concat(C.iconFilename):null;return(0,l.jsxs)("div",{className:"container ".concat(e),children:[(0,l.jsxs)("div",{className:"page-header",children:[(0,l.jsx)("h1",{children:"Add New Project"}),(0,l.jsx)(o(),{href:"/",className:"back-link",children:"← Back to Dashboard"})]}),(0,l.jsx)("div",{className:"add-form-container",children:(0,l.jsxs)("form",{onSubmit:_,className:"add-form",children:[g&&(0,l.jsx)("p",{className:"error-message",children:g}),b&&(0,l.jsx)("p",{className:"success-message",children:b}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"icon-upload",children:"Project Icon"}),(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:[T&&(0,l.jsx)(i.default,{src:T,alt:"Icon Preview",width:40,height:40,style:{borderRadius:"5px"},unoptimized:!0}),(0,l.jsx)("input",{type:"file",id:"icon-upload",name:"icon",onChange:E,accept:"image/*"})]}),N&&(0,l.jsx)("small",{style:{color:"var(--color-error-text)",marginTop:"5px"},children:N}),(0,l.jsx)("small",{children:"Upload an icon (optional). It will populate the read-only path field below."})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"iconFilename",children:"Icon Path (read-only):"}),(0,l.jsx)("input",{type:"text",name:"iconFilename",value:C.iconFilename,readOnly:!0})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"projectName",children:"Name:"}),(0,l.jsx)("input",{type:"text",name:"projectName",value:C.projectName,onChange:k,required:!0,autoFocus:!0})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"description",children:"Description:"}),(0,l.jsx)("input",{type:"text",name:"description",value:C.description,onChange:k})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"startCommand",children:"Start Command:"}),(0,l.jsx)("input",{type:"text",name:"startCommand",value:C.startCommand,onChange:k,required:!0,placeholder:"e.g., npm run start"})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"stopCommand",children:"Stop Command:"}),(0,l.jsx)("input",{type:"text",name:"stopCommand",value:C.stopCommand,onChange:k,placeholder:"e.g., kill-port 8000"})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"port",children:"Port:"}),(0,l.jsx)("input",{type:"number",name:"port",value:C.port,onChange:k,required:!0,placeholder:"e.g., 8000"})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"scheme",children:"Scheme:"}),(0,l.jsxs)("select",{name:"scheme",value:C.scheme,onChange:k,children:[(0,l.jsx)("option",{value:"http",children:"http"}),(0,l.jsx)("option",{value:"httpss",children:"https"})]})]}),(0,l.jsxs)("div",{className:"form-group",children:[(0,l.jsx)("label",{htmlFor:"host",children:"Host:"}),(0,l.jsx)("input",{type:"text",name:"host",value:C.host,onChange:k,placeholder:h||"e.g., localhost"})]}),(0,l.jsxs)("div",{className:"form-group label-selector",children:[(0,l.jsx)("label",{htmlFor:"labels",children:"Assign Labels:"}),r?(0,l.jsx)("p",{children:"Loading..."}):d?(0,l.jsx)("p",{className:"error-message",children:d}):(0,l.jsx)(m,{instanceId:"add-project-label-select",inputId:"labels",isMulti:!0,name:"labels",options:I(),className:"react-select-instance",classNamePrefix:"react-select",value:w,onChange:e=>{S(e)}})]}),(0,l.jsx)("button",{type:"submit",className:"action-button add-button",disabled:j||r,children:j?"Adding...":"Add Project"})]})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[874,701,441,684,358],()=>t(2963)),_N_E=e.O()}]);