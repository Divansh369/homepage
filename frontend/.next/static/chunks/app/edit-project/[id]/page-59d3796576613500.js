(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[223],{1312:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>h});var s=a(5155),o=a(2115),r=a(6874),l=a.n(r),n=a(5695),i=a(5028),c=a(6352),d=a(6766);let m=(0,i.default)(()=>a.e(183).then(a.bind(a,9183)),{loadableGenerated:{webpack:()=>[9183]},ssr:!1,loading:()=>(0,s.jsx)("div",{style:{minHeight:"38px",padding:"8px 10px",border:"1px solid #ccc",borderRadius:"4px",backgroundColor:"#eee",color:"#aaa"},children:"Loading..."})});function h(){var e;let{theme:t}=(0,c.D)(),a=(0,n.useRouter)(),r=(0,n.useParams)().id,[i,h]=(0,o.useState)({projectName:"",description:"",iconFilename:"",startCommand:"",stopCommand:"",scheme:"http",port:"",host:""}),[p,u]=(0,o.useState)([]),[j,x]=(0,o.useState)([]),[f,g]=(0,o.useState)(!0),[v,b]=(0,o.useState)(!1),[N,C]=(0,o.useState)(null),[y,F]=(0,o.useState)(null),[w,S]=(0,o.useState)(null),P=(0,o.useCallback)(()=>j.map(e=>({value:String(e.id),label:"".concat(e.name," (").concat(e.label_type,")")})),[j]);(0,o.useEffect)(()=>{r&&(async()=>{g(!0),C(null);try{let[e,t]=await Promise.all([fetch("/api/project/".concat(r)),fetch("/api/labels")]);if(!e.ok){let t=await e.json();throw Error("Project fetch failed: ".concat(t.error||e.status))}if(!t.ok)throw Error("Labels fetch failed: ".concat(t.status));let a=await e.json(),s=await t.json();x(s),h({projectName:a.project_name||"",description:a.description||"",iconFilename:a.icon_filename||"",startCommand:a.start_command||"",stopCommand:a.stop_command||"",scheme:a.scheme||"http",port:String(a.port||""),host:a.host||""});let o=s.map(e=>({value:String(e.id),label:"".concat(e.name," (").concat(e.label_type,")")})).filter(e=>a.Labels.includes(parseInt(e.value)));u(o)}catch(e){C("Failed to load data: ".concat(e.message))}finally{g(!1)}})()},[r]);let k=e=>{h(t=>({...t,[e.target.name]:e.target.value}))},E=async e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!a)return;S(null);let s=new FormData;s.append("icon",a);try{let e=await fetch("/api/upload/icon",{method:"POST",body:s}),t=await e.json();if(!e.ok)throw Error(t.error||"Upload failed");h(e=>({...e,iconFilename:t.filePath}))}catch(e){S(e.message)}},_=async e=>{e.preventDefault(),C(null),F(null),b(!0);let t=p.map(e=>parseInt(e.value)),s={...i,selectedLabels:t};try{let e=await fetch("/api/projects/".concat(r),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),t=await e.json();if(!e.ok)throw Error(t.error||"Failed to update project");F('Project "'.concat(s.projectName,'" updated successfully!')),setTimeout(()=>a.push("/"),2e3)}catch(e){C("Failed to update project: ".concat(e.message))}finally{b(!1)}};if(f)return(0,s.jsx)("div",{className:"container ".concat(t),children:(0,s.jsx)("p",{className:"loading-indicator",children:"Loading project data..."})});if(N&&!i.projectName)return(0,s.jsxs)("div",{className:"container ".concat(t),children:[(0,s.jsx)("p",{className:"error-message",children:N}),(0,s.jsx)(l(),{href:"/",children:"← Back to Dashboard"})]});let I=(null===(e=i.iconFilename)||void 0===e?void 0:e.startsWith("/uploads"))?"".concat("http://localhost:1024").concat(i.iconFilename):i.iconFilename;return(0,s.jsxs)("div",{className:"container ".concat(t),children:[(0,s.jsxs)("div",{className:"page-header",children:[(0,s.jsxs)("h1",{children:["Edit Project: ",i.projectName]}),(0,s.jsx)(l(),{href:"/",className:"back-link",children:"← Back to Dashboard"})]}),(0,s.jsx)("div",{className:"add-form-container",children:(0,s.jsxs)("form",{onSubmit:_,className:"add-form",children:[N&&(0,s.jsx)("p",{className:"error-message",children:N}),y&&(0,s.jsx)("p",{className:"success-message",children:y}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{htmlFor:"icon-upload",children:"Project Icon"}),(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"15px"},children:[I&&(0,s.jsx)(d.default,{src:I,alt:"Icon Preview",width:40,height:40,style:{borderRadius:"5px",border:"1px solid var(--color-border)"},unoptimized:!0}),(0,s.jsx)("input",{type:"file",id:"icon-upload",name:"icon",onChange:E,accept:"image/*"})]}),w&&(0,s.jsx)("small",{style:{color:"var(--color-error-text)",marginTop:"5px"},children:w}),(0,s.jsx)("small",{children:"Upload an image to replace the icon path below."})]}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{htmlFor:"iconFilename",children:"Icon Path:"}),(0,s.jsx)("input",{type:"text",id:"iconFilename",name:"iconFilename",value:i.iconFilename,onChange:k,placeholder:"/uploads/icons/...",readOnly:!0})]}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{htmlFor:"projectName",children:"Name:"}),(0,s.jsx)("input",{type:"text",id:"projectName",name:"projectName",value:i.projectName,onChange:k,required:!0})]}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{htmlFor:"description",children:"Description:"}),(0,s.jsx)("input",{type:"text",id:"description",name:"description",value:i.description,onChange:k})]}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{htmlFor:"startCommand",children:"Start Command:"}),(0,s.jsx)("input",{type:"text",id:"startCommand",name:"startCommand",value:i.startCommand,onChange:k,required:!0})]}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{htmlFor:"stopCommand",children:"Stop Command:"}),(0,s.jsx)("input",{type:"text",id:"stopCommand",name:"stopCommand",value:i.stopCommand,onChange:k})]}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{htmlFor:"port",children:"Port:"}),(0,s.jsx)("input",{type:"number",id:"port",name:"port",value:i.port,onChange:k,required:!0})]}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{htmlFor:"scheme",children:"Scheme:"}),(0,s.jsxs)("select",{id:"scheme",name:"scheme",value:i.scheme,onChange:k,children:[(0,s.jsx)("option",{value:"http",children:"http"}),(0,s.jsx)("option",{value:"https",children:"https"})]})]}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{htmlFor:"host",children:"Host:"}),(0,s.jsx)("input",{type:"text",id:"host",name:"host",value:i.host,onChange:k})]}),(0,s.jsxs)("div",{className:"form-group label-selector",children:[(0,s.jsx)("label",{htmlFor:"labels",children:"Assign Labels:"}),(0,s.jsx)(m,{instanceId:"edit-project-label-select",inputId:"labels",isMulti:!0,name:"labels",options:P(),className:"react-select-instance",classNamePrefix:"react-select",value:p,onChange:e=>{u(e)}})]}),(0,s.jsx)("button",{type:"submit",className:"action-button add-button",disabled:v,children:v?"Saving...":"Save Changes"})]})})]})}},5695:(e,t,a)=>{"use strict";var s=a(8999);a.o(s,"useParams")&&a.d(t,{useParams:function(){return s.useParams}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}})},6352:(e,t,a)=>{"use strict";a.d(t,{D:()=>n,N:()=>l});var s=a(5155),o=a(2115);let r=(0,o.createContext)(void 0),l=e=>{let{children:t}=e,[a,l]=(0,o.useState)("light");(0,o.useEffect)(()=>{let e=localStorage.getItem("theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches,a=e||(t?"dark":"light");l(a),document.documentElement.setAttribute("data-theme",a)},[]);let n=()=>{l(e=>{let t="light"===e?"dark":"light";return localStorage.setItem("theme",t),document.documentElement.setAttribute("data-theme",t),t})},i=(0,o.useMemo)(()=>({theme:a,toggleTheme:n}),[a]);return(0,s.jsx)(r.Provider,{value:i,children:t})},n=()=>{let e=(0,o.useContext)(r);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}},7140:(e,t,a)=>{Promise.resolve().then(a.bind(a,1312))}},e=>{var t=t=>e(e.s=t);e.O(0,[874,701,441,684,358],()=>t(7140)),_N_E=e.O()}]);